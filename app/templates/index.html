{% extends "base.html" %}
{% block content %}

<section class="glass card pad">
	<h1 class="h1">Daily Log</h1>
	<form class="grid add-form" method="post" action="/add-entry">
		<label>
			<span>Date</span>
			<input type="date" name="date_value" value="{{ today }}" required />
		</label>
		<label>
			<span>Activity</span>
			<select name="activity_id" required>
				<option value="" disabled selected>Select activity</option>
				{% for a in activities %}
				<option value="{{ a.id }}">{{ a.name }} â€” {{ a.category.name }}</option>
				{% endfor %}
			</select>
		</label>
		<label>
			<span>Duration (minutes)</span>
			<input type="number" name="duration_minutes" min="1" max="1440" step="1" value="30" required />
		</label>
		<label class="notes">
			<span>Notes</span>
			<input type="text" name="notes" placeholder="Optional notes" />
		</label>
		<div class="actions">
			<button class="btn primary" type="submit">Add</button>
			<div class="quick-add">
				<button class="btn" type="button" data-mins="15">+15</button>
				<button class="btn" type="button" data-mins="30">+30</button>
				<button class="btn" type="button" data-mins="45">+45</button>
				<button class="btn" type="button" data-mins="60">+60</button>
			</div>
		</div>
	</form>
</section>

<section class="glass card pad">
	<h2 class="h2">Entries for {{ today }}</h2>
	{% if entries %}
	<table class="table">
		<thead>
			<tr><th>Category</th><th>Activity</th><th>Duration</th><th>Notes</th><th></th></tr>
		</thead>
		<tbody>
			{% for e in entries %}
			<tr>
				<td><span class="chip" style="--chip-bg: {{ e.category.color_hex }}22; --chip-border: {{ e.category.color_hex }};">{{ e.category.name }}</span></td>
				<td>{{ e.activity.name if e.activity else '' }}</td>
				<td>{{ e.duration_minutes }} min</td>
				<td>{{ e.notes or '' }}</td>
				<td>
					<form method="post" action="/delete-entry">
						<input type="hidden" name="entry_id" value="{{ e.id }}" />
						<button class="btn danger" type="submit">Delete</button>
					</form>
				</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
	{% else %}
	<p class="muted">No entries for today yet.</p>
	{% endif %}
	<div class="row end">
		<a class="btn" href="/entries/export.csv?from_date={{ today }}&to_date={{ today }}">Export CSV (today)</a>
	</div>
</section>

{% endblock %}


